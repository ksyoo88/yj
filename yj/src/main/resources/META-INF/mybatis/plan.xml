<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.yj.dao.PlanDao">
	<!-- 
		resultMap 은 컬럼명과 클래스의 변수명을 매핑한다
		type에는 결과값을 담을 객체의 클래스명
		id에는 <select/>resultMap에서 사용할이름
	 -->
	 <resultMap type="Plan" id="plan">		
		<result column="PLAN_NO" property="no"/>
		<result column="MEM_NO" property="member.no"/>
		<result column="PLAN_TITLE" property="title"/>
		<result column="PLAN_TREVEL_CNT" property="trevelCnt"/>
		<result column="PLAN_START_DAY" property="startDayDate"/>
		<result column="PLAN_FINISH_DAY" property="finishDayDate"/>
		<result column="PLAN_LIKE_CNT" property="likeCnt"/>
		
	 </resultMap>
	 
	<!-- PlaceAreaPoint 사용해라 -->
	 
	<insert id="insertPlan" parameterType="Plan">
		INSERT INTO YJ_PLAN( PLAN_NO,
							 MEM_NO, 
							 PLAN_TITLE, 
							 PLAN_TREVEL_CNT, 
							 PLAN_START_DAY,  
							 PLAN_FINISH_DAY, 
							 PLAN_LIKE_CNT)
		VALUES (#{no}, #{member.no}, #{title} , #{trevelCnt} , #{startDayDate},  #{finishDayDate}, 0)
	</insert>
	
	<select id="getPlanSeq" resultType="int">
		SELECT PLAN_SEQ.NEXTVAL
		FROM DUAL
	</select>

	<select id="getPlanByNo" parameterType="int" resultMap="plan">
		SELECT  PLAN_NO, 
				MEM_NO,
				PLAN_TITLE, 
				PLAN_TREVEL_CNT, 
				PLAN_START_DAY,
				PLAN_FINISH_DAY,
				PLAN_LIKE_CNT
		FROM YJ_PLAN
		WHERE PLAN_NO = #{value}
	</select>
	
	<select id="getPlanDaySeq" resultType="int">
		SELECT PLAN_DAY_SEQ.NEXTVAL
		FROM DUAL	
	</select>
	
	<insert id="insertPlanDay" parameterType="PlanDay">
		INSERT INTO YJ_PLAN_DAY (PLAN_NO, PLAN_DAY_NO, PLAN_DAY_DATE, CONTENTID)
		VALUES( #{plan.no}, #{no}, #{dayDate}, #{place.contentid} ) 
	</insert>
	
	

	
</mapper>